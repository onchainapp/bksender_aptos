(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{707:function(e,t,r){"use strict";r.r(t);r(61),r(50),r(28),r(45),r(145);var n,o=r(1),c=(r(708),r(158),r(62),r(90),r(79),r(96),r(709),r(30),r(0)),m=(r(74),r(75),r(26),r(118)),l=r(3),d=r(103),f=r(58);function k(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v,T,E,A,w,x,_,O,y,S,R,C,P,N,I,j,L,D=function(e){e.newAccount,e.commit},G=function(e){e.newChain,e.commit},K={netId:function(e){return e.netId},isApiValible:function(e){return 1==e.netId},networkName:function(e){return m.a["netId".concat(e.netId)].networkName},currency:function(e){return m.a["netId".concat(e.netId)].currencyName},miniDeposit:function(e){return Object(l.a)(e.minDeposiBalance).div(Object(l.a)(10).pow(e.decimals)).toString(10)},networkConfig:function(e){var t=m.a["netId".concat(e.netId)];return e.workedRPC&&(t.rpcUrl=e.workedRPC),t},getEthereumProvider:function(e,t){return Object(c.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.providerName,e.networkName,t.t0=r,t.next="Martian"===t.t0?4:"Fewcha"===t.t0?5:"Pontem"===t.t0?6:"SafePal"===t.t0?7:(t.t0,8);break;case 4:return t.abrupt("return",window.martian);case 5:return t.abrupt("return",window.fewcha);case 6:return t.abrupt("return",window.pontem);case 7:return t.abrupt("return",window.safePal);case 8:return t.abrupt("return",window.aptos);case 9:case"end":return t.stop()}}),t)})))},aptosClient:function(e,t){return Object(c.a)(regeneratorRuntime.mark((function e(){var r,n,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>0&&void 0!==c[0]?c[0]:void 0,n=t.networkConfig.rpcUrl,r&&(n=r),o=new f.a(n),e.abrupt("return",Object.freeze(o));case 5:case"end":return e.stop()}}),e)})))}},B={IDENTIFY:function(e,t){e.ethAccount=t},SET_NET_ID:function(e,t){t=parseInt(t,10),e.netId=t},SET_BALANCE:function(e,t){e.balance=Object(l.a)(t).div(Object(l.a)(10).pow(Object(l.a)(e.decimals))).toString(10)},SET_WALLET_STATE:function(e,t){e.walletState=t},SET_ADDRESS:function(e,t){var address=t.address,r=t.valid,n=void 0!==r&&r;e.address={value:address,valid:n}},SET_PUBLICKEY:function(e,t){e.accountPublicKey=t},SAVE_GAS_PRICE:function(e,t){e.gasPrice=t},SAVE_TOKENS_LIST:function(e,t){e.tokensList=t},SAVE_WORKED_RPC:function(e,t){e.workedRPC=t},SET_GAS_PRICE_ORACLE_LOCKED:function(e,t){e.gasPriceOracleLocked=t},SAVE_TOKENS:function(e,t){e.tokens=t},SET_TOKEN_ADDRESS:function(e,t){e.tokenAddress=t},SET_FETCHING:function(e,t){e.isFetching=t},SET_PROVIDER_NAME:function(e,t){e.providerName=t},SET_NETWORK_NAME:function(e,t){e.networkName=t},SET_INITIALIZED:function(e,t){e.initialized=t},SET_IS_IMTOKEN:function(e,t){e.isImToken=t},SET_IS_TRUSTWALLET:function(e,t){e.isTrustWallet=t},SET_WALLET_NAME:function(e,t){e.walletName=t},SET_MIN_DEPOSIT_BALANCE:function(e,t){e.minDeposiBalance=t},SAVE_ETH_PRICE:function(e,t){e.ethPrice=t},SET_ETH_PRICE_LOADED:function(e,t){e.ethPriceLoaded=t},SET_MIN_TOKEN_ACCOUNT_INIT_AMOUNT:function(e,t){e.minTokenAccountInitAmount=t},SET_MIN_GAS_FEE:function(e,t){e.minGasFee=t},SET_FEE_RATE_GOVERNOR:function(e,t){e.feeRateGovernor=t}},F=(n={setAddress:function(e,t){e.dispatch;(0,e.commit)("SET_ADDRESS",{address:t.address,valid:!0})},setTokenAddress:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_ADDRESS",t.address)},setWalletName:function(e,t){var r=e.dispatch,n=e.commit,o=t.walletName;n("SET_WALLET_NAME",o),r("common/saveLastUsedWalletName",{walletName:o},{root:!0})},onNetworkChanged:function(e,t){(0,e.commit)("SET_NET_ID",t.netId)},onChainIdChanged:function(e,t){var r=e.commit,n=t.chainId;r("SET_NET_ID",hexToNumber(n))},closeProvider:(L=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,n=t.getters,o=t.commit,r.providerName,e.next=4,n.getEthereumProvider();case 4:return c=e.sent,e.next=7,c.disconnect();case 7:return o("IDENTIFY",null),o("SET_PROVIDER_NAME",""),o("SET_WALLET_NAME",""),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)}))),function(e,t){return L.apply(this,arguments)}),getBalance:function(e){e.dispatch;var t=e.state,r=e.getters,n=e.rootGetters,o=r.networkConfig.rpcCallRetryAttempt;return new Promise((function(e,r){var m=function(){var l=Object(c.a)(regeneratorRuntime.mark((function c(l){var d,f,k,h,v;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(d=l.retryAttempt,f=void 0===d?1:d,f++,c.prev=2,!t.ethAccount){c.next=14;break}return c.next=6,n["metamask/aptosClient"]();case 6:return k=c.sent,c.next=9,k.getAccountResource(t.ethAccount,"0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>");case 9:h=c.sent,v=h.data.coin.value,e(v),c.next=15;break;case 14:e(0);case 15:c.next=21;break;case 17:c.prev=17,c.t0=c.catch(2),console.info(c.t0),c.t0.message.includes("Resource not found by")?e(0):f>=o?r(c.t0):m({retryAttempt:f});case 21:case"end":return c.stop()}}),c,null,[[2,17]])})));return function(e){return l.apply(this,arguments)}}();m({})}))},getBlockHeight:(j=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,n=t.rootGetters,t.rootState,t.dispatch,t.commit,o=r.customRPC,m=void 0===o?void 0:o,e.abrupt("return",new Promise((function(e,t){var r=function(){var o=Object(c.a)(regeneratorRuntime.mark((function o(c){var l,d,f,k;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l=c.retryAttempt,d=void 0===l?1:l,o.prev=1,o.next=4,n["metamask/aptosClient"](m);case 4:return f=o.sent,o.next=7,f.getLedgerInfo();case 7:k=o.sent,e(k),o.next=15;break;case 11:o.prev=11,o.t0=o.catch(1),++d>=2?t(o.t0):r({retryAttempt:d});case 15:case"end":return o.stop()}}),o,null,[[1,11]])})));return function(e){return o.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return j.apply(this,arguments)}),checkRPCService:(I=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n,o,m,l,d,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,t.state,n=t.getters,t.rootGetters,o=t.commit,m=n.networkConfig,l=m.rpcUrl,null==(d=m.backupRpcs)&&(d=[l]),f=[l].concat(d),k=f.length,e.abrupt("return",new Promise((function(e,t){var n=function(){var m=Object(c.a)(regeneratorRuntime.mark((function c(m){var l,d,h,v;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=m.retryAttempt,d=void 0===l?0:l,c.prev=1,h=f[d%f.length],c.next=5,r("getBlockHeight",{customRPC:h});case 5:v=c.sent,console.info("Block Height",v.block_height),v&&o("SAVE_WORKED_RPC",h),e(v),c.next=15;break;case 11:c.prev=11,c.t0=c.catch(1),++d>=k?t(c.t0):n({retryAttempt:d});case 15:case"end":return c.stop()}}),c,null,[[1,11]])})));return function(e){return m.apply(this,arguments)}}();n({})})));case 6:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)}),askPermission:function(e,t){var r=e.commit,n=e.dispatch,o=e.getters,m=(e.state,t.providerName),l=t.networkName;return new Promise(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(t,c){var d,f,k,h,v,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r("SET_PROVIDER_NAME",m),r("SET_NETWORK_NAME",l),r("SET_INITIALIZED",!1),e.next=5,o.getEthereumProvider();case 5:return d=e.sent,f=void 0,e.prev=7,null==d&&(r("SET_WALLET_STATE",-1),c(new Error("Please Install Metamask"))),e.next=11,d.connect();case 11:if((k=e.sent)&&k.publicKey&&(f=k.address),k&&k.data&&k.data.address&&(f=k.data.address),console.info("account",f),null!=f){e.next=19;break}return r("SET_WALLET_STATE",-2),c(new Error("lockedMetamask")),e.abrupt("return");case 19:return r("IDENTIFY",f),n("setAddress",{address:f}),r("SET_WALLET_STATE",1),d.onNetworkChange&&d.onNetworkChange((function(e){G({dispatch:n,commit:r,name:e})})),d.onChangeNetwork&&d.onChangeNetwork((function(e){G({dispatch:n,commit:r,name:e})})),d.onAccountChanged&&d.accountChanged((function(e){alert(1),D({dispatch:n,commit:r,newAccount:e})})),d.onAccountChange&&d.onAccountChange((function(e){D({dispatch:n,commit:r,newAccount:e})})),d.onChangeAddress&&d.onChangeAddress((function(e){D({dispatch:n,commit:r,newAccount:e})})),h=1,v="Mainnet",e.prev=29,e.next=32,d.network();case 32:(v=e.sent).name&&(v=v.name),e.next=42;break;case 36:return e.prev=36,e.t0=e.catch(29),e.next=40,d.getNetwork();case 40:(v=e.sent).data&&(v=v.data);case 42:return v.toLowerCase().includes("testnet")&&(h=2),v.toLowerCase().includes("devnet")&&(h=42),n("onNetworkChanged",{netId:h}),e.prev=45,e.next=48,n("checkRPCService",{});case 48:e.next=53;break;case 50:e.prev=50,e.t1=e.catch(45),console.info(e.t1);case 53:return e.next=55,n("getBalance");case 55:T=e.sent,n("saveUserBalance",{balance:T}),r("SET_INITIALIZED",!0),n("common/saveLastUsedProviderName",{providerName:m},{root:!0}),n("fetchTokenList",{}),n("fetchGasPrice",{}),n("bulksender/initBaseParams",{},{root:!0}),n("common/initBaseParams",{},{root:!0}),n("token/initBaseParams",{},{root:!0});try{n("fetchCoinPrice")}catch(e){}t({netId:h,ethAccount:ethAccounts[0]}),e.next=71;break;case 68:e.prev=68,e.t2=e.catch(7),c(e.t2);case 71:case"end":return e.stop()}}),e,null,[[7,68],[29,36],[45,50]])})));return function(t,r){return e.apply(this,arguments)}}())},saveUserBalance:function(e,t){(0,e.commit)("SET_BALANCE",t.balance)},fetchETHBalance:(N=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,t.commit,e.prev=1,e.next=4,r("getBalance");case 4:n=e.sent,r("saveUserBalance",{balance:n}),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(e){return N.apply(this,arguments)}),fetchTokenList:(P=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,d,f,k,h,v,T,E,A,w,x,_,O,y,S,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.rootState,o=t.commit,c=t.dispatch,m=t.rootGetters,d=t.state,r.oracleIndex,(f=m["metamask/networkConfig"]).smartContractPollTime,f.gasPrice,f.tokenOracleUrls,k=f.currencyName,h=f.networkName,v=f.specialTokenList,(T=n.metamask).netId,T.isFetching,T.ethAccount,T.tokens,E=T.balance,A=T.ethCoinName,n.common.language,e.next=7,m["metamask/aptosClient"]();case 7:return w=e.sent,e.prev=8,e.next=11,w.getAccountResources(d.ethAccount);case 11:x=e.sent,_=[],O=["0x0000000000000000000000000000000000000000"].concat(v),y=h+A,_.push({symbol:k,name:y,balance:Object(l.a)(E).times(Object(l.a)(10).pow(d.decimals)).toString(10),displayBalance:E,contractAddress:"0x0000000000000000000000000000000000000000",decimals:d.decimals,isETH:!0}),S=["0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>","0x1::account::Account","0x3::token::TokenStore","0x3::token::Collections"],R=d.tokensList,x.forEach((function(e,i){var t=e.type;if(!S.includes(t)&&e.data.coin){var r=e.data.coin.value,n=t.replace("0x1::coin::CoinStore","");n.startsWith("<")&&(n=n.substring(1,n.length)),n.endsWith(">")&&(n=n.substring(0,n.length-1));var o=r,c=(r.toString(),R[n.toLowerCase()]);c||(c={symbol:"T",name:"Coin"});var m={symbol:c.symbol,name:c.name,balance:o,displayBalance:0,contractAddress:n,decimals:0};_.push(m),v.includes(m.contractAddress)||O.push(m.contractAddress)}})),_.sort((function(a,b){return O.indexOf(a.contractAddress)-O.indexOf(b.contractAddress)})),o("SAVE_TOKENS",_),o("SET_FETCHING",!1),c("fetchTokenMetaInfo",{}),e.next=30;break;case 25:return e.prev=25,e.t0=e.catch(8),console.info(e.t0),e.next=30,c("setDefaultTokenList");case 30:case"end":return e.stop()}}),e,null,[[8,25]])}))),function(e,t){return P.apply(this,arguments)}),fetchTokenInfo:(C=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,f,k,h,v,T,E,A,w,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rootState,o=t.commit,c=t.dispatch,m=t.rootGetters,t.state,l=r.oracleIndex,f=void 0===l?0:l,(k=m["metamask/networkConfig"]).smartContractPollTime,h=k.tokenOracleUrls,(v=n.metamask).netId,v.ethAccount,v.tokens,e.prev=4,f!=h.length){e.next=9;break}return e.abrupt("return",{});case 9:return T=h[f%h.length],E=T.indexOf("cdn.jsdelivr.net")>-1,A={},e.next=14,Object(d.a)(T);case 14:if(200!==(w=e.sent).status){e.next=24;break}return e.next=18,w.json();case 18:return x=e.sent,E&&x.forEach((function(e,i){A[e.token_type.type.toLowerCase()]={symbol:e.symbol,name:e.name}})),o("SAVE_TOKENS_LIST",A),e.abrupt("return",A);case 24:return f++,e.next=27,c("fetchTokenInfo",{oracleIndex:f});case 27:e.next=33;break;case 29:return e.prev=29,e.t0=e.catch(4),console.info(e.t0),e.abrupt("return",{});case 33:case"end":return e.stop()}}),e,null,[[4,29]])}))),function(e,t){return C.apply(this,arguments)}),fetchTokenMetaInfo:(R=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,d,f,k,h,v,T,E,A,w,x,_,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rootState,o=t.commit,c=t.dispatch,m=t.rootGetters,d=t.state,f=r.oracleIndex,k=void 0===f?0:f,h=m["metamask/networkConfig"].graphqlUrls,v=n.metamask.tokens,e.prev=4,!(k==h.length&&v.length>1)){e.next=9;break}return e.abrupt("return",{});case 9:return T=h[k%h.length],E="\n  query MyQuery {\n    coin_infos(\n      limit: $limit\n      distinct_on: coin_type\n      where: {coin_type: {_in: [$coins]}}\n    ) {\n      name\n      decimals\n      symbol\n      coin_type\n    }\n  }\n",A=[],v.forEach((function(e,i){"0x0000000000000000000000000000000000000000"!=e.contractAddress&&A.push('"'+e.contractAddress+'"')})),w=A.join(","),E=(E=E.replace("$coins",w)).replace("$limit",A.length),e.next=18,c("sendGraphQLRequest",{operationsDoc:E,customGraphqlURL:T});case 18:return x=e.sent,_=Object.assign([],d.tokensList),x.data&&x.data.coin_infos&&x.data.coin_infos.forEach((function(e,i){_[e.coin_type.toLowerCase()]={symbol:e.symbol,name:e.name,decimals:e.decimals}})),O=[],v.forEach((function(e,i){var t=Object.assign({},e),r=_[e.contractAddress.toLowerCase()];r&&(t.decimals=r.decimals,t.symbol=r.symbol,t.name=r.name,t.displayBalance=Object(l.a)(t.balance).div(Object(l.a)(10).pow(t.decimals)).toString(10)),O.push(t)})),o("SAVE_TOKENS",O),o("SAVE_TOKENS_LIST",_),e.abrupt("return",_);case 26:e.next=34;break;case 28:return e.prev=28,e.t0=e.catch(4),console.info(e.t0),k++,e.next=34,c("fetchTokenMetaInfo",{oracleIndex:k});case 34:case"end":return e.stop()}}),e,null,[[4,28]])}))),function(e,t){return R.apply(this,arguments)}),setDefaultTokenList:(S=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,d,f,k,h,v,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.rootState,n=t.commit,t.dispatch,o=t.rootGetters,c=t.state,(m=o["metamask/networkConfig"]).smartContractPollTime,m.gasPrice,m.tokenOracleUrls,d=m.currencyName,f=m.networkName,m.specialTokenList,(k=r.metamask).netId,k.isFetching,k.ethAccount,k.tokens,h=k.balance,v=k.ethCoinName,r.common.language,(T=[]).push({symbol:d,name:f+v,balance:Object(l.a)(h).times(Object(l.a)(10).pow(c.decimals)).toString(10),displayBalance:h,contractAddress:"0x0000000000000000000000000000000000000000",decimals:c.decimals,isETH:!0}),n("SAVE_TOKENS",T),n("SET_FETCHING",!1);case 8:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)}),fetchGasPrice:(y=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,f,k,v,T,E,A,w,x,_,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rootState,o=t.commit,c=t.dispatch,m=t.rootGetters,f=t.state,k=r.oracleIndex,v=void 0===k?0:k,T=m["metamask/networkConfig"],E=T.smartContractPollTime,A=T.gasPrice,T.gasOracleUrls,n.metamask.netId,!f.gasPriceOracleLocked){e.next=8;break}return console.info("GasPrice Oracle locked"),setTimeout((function(){return c("fetchGasPrice",{})}),1e3*E),e.abrupt("return");case 8:return e.prev=8,e.next=11,m["metamask/aptosClient"]();case 11:return w=e.sent,e.next=15,Object(d.a)(w.nodeUrl+"/estimate_gas_price");case 15:if(200!==(x=e.sent).status){e.next=29;break}return e.next=19,x.json();case 19:_=e.sent,O=h({},A),_.deprioritized_gas_estimate&&(O.slow=Number(_.deprioritized_gas_estimate)),_.gas_estimate&&(O.standard=Number(_.gas_estimate)),_.prioritized_gas_estimate&&(O.fast=Number(_.prioritized_gas_estimate)),O.instant=Object(l.a)(O.fast).plus(Object(l.a)(10)).toNumber(),o("SAVE_GAS_PRICE",O),e.next=30;break;case 29:throw Error("Fetch gasPrice failed");case 30:setTimeout((function(){return c("fetchGasPrice",{})}),1e3*E),e.next=34;break;case 33:o("SAVE_GAS_PRICE",A);case 34:e.next=41;break;case 36:e.prev=36,e.t0=e.catch(8),console.error(e.t0),v++,setTimeout((function(){return c("fetchGasPrice",{oracleIndex:v})}),1e3*E);case 41:case"end":return e.stop()}}),e,null,[[8,36]])}))),function(e,t){return y.apply(this,arguments)}),updateGasPrice:(O=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.state,t.getters,t.rootGetters,t.rootState,t.dispatch,n=t.commit,o=r.gasPrices,(c=Object.assign({},o)).fast=40,n("SAVE_GAS_PRICE",c);case 5:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)}),fetchCoinPrice:(_=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n,o,m,l,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rootState,n=t.commit,o=t.dispatch,m=t.rootGetters,t.state,(l=m["metamask/networkConfig"]).smartContractPollTime,f=l.extraFeeOracle,k=l.supportExtraFee,r.metamask.netId,k){e.next=6;break}return n("SET_ETH_PRICE_LOADED",!0),e.abrupt("return");case 6:return e.abrupt("return",new Promise((function(e,t){var r=function(){var m=Object(c.a)(regeneratorRuntime.mark((function c(m){var l,k,h,v,T,E,A;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=m.retryAttempt,k=void 0===l?1:l,k++,c.prev=2,c.next=5,Object(d.a)(f.coinPriceUrl,{timeout:5e3});case 5:if(200!==(h=c.sent).status){c.next=17;break}return c.next=9,h.json();case 9:v=c.sent,T=0,v.hasOwnProperty(f.coinId)&&(T=v[f.coinId].usd),n("SAVE_ETH_PRICE",T),n("SET_ETH_PRICE_LOADED",!0),e(T),c.next=18;break;case 17:throw Error("Fetch coin price failed");case 18:c.next=41;break;case 20:if(c.prev=20,c.t0=c.catch(2),!(k>=2)){c.next=40;break}if(!(E=f.coinBackups)||!E.length){c.next=37;break}return c.prev=25,c.next=28,o("fetchCoinPriceFromBackups");case 28:A=c.sent,e(A),c.next=35;break;case 32:c.prev=32,c.t1=c.catch(25),t(c.t1);case 35:c.next=38;break;case 37:t(c.t0);case 38:c.next=41;break;case 40:r({retryAttempt:k});case 41:case"end":return c.stop()}}),c,null,[[2,20],[25,32]])})));return function(e){return m.apply(this,arguments)}}();r({})})));case 8:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)}),fetchCoinPriceFromBackups:(x=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n,o,m,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rootState,n=t.commit,t.dispatch,o=t.rootGetters,t.state,(m=o["metamask/networkConfig"]).smartContractPollTime,l=m.extraFeeOracle,f=m.supportExtraFee,r.metamask.netId,f){e.next=6;break}return n("SET_ETH_PRICE_LOADED",!0),e.abrupt("return");case 6:return e.abrupt("return",new Promise((function(e,t){var r=function(){var o=Object(c.a)(regeneratorRuntime.mark((function o(c){var m,f,k,h,v,T,E;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(m=c.retryAttempt,f=void 0===m?1:m,f++,o.prev=2,!(k=l.coinBackups)){o.next=20;break}return h=k[f%k.length],o.next=8,Object(d.a)(h);case 8:if(200!==(v=o.sent).status){o.next=19;break}return o.next=12,v.json();case 12:T=o.sent,E=T.price,n("SAVE_ETH_PRICE",E),n("SET_ETH_PRICE_LOADED",!0),e(E),o.next=20;break;case 19:throw Error("Fetch coin price failed");case 20:o.next=26;break;case 22:o.prev=22,o.t0=o.catch(2),console.info(o.t0),f>=2?t(o.t0):r({retryAttempt:f});case 26:case"end":return o.stop()}}),o,null,[[2,22]])})));return function(e){return o.apply(this,arguments)}}();r({})})));case 8:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)})},Object(o.a)(n,"updateGasPrice",(w=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.state,t.getters,t.rootGetters,t.rootState,t.dispatch,n=t.commit,o=r.gasPrices,(c=Object.assign({},o)).fast=40,n("SAVE_GAS_PRICE",c);case 5:case"end":return e.stop()}}),e)}))),function(e){return w.apply(this,arguments)})),Object(o.a)(n,"lockGasPriceOracle",(A=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state,t.getters,t.rootGetters,t.rootState,t.dispatch,n=t.commit,o=r.gasPriceOracleLocked,n("SET_GAS_PRICE_ORACLE_LOCKED",o);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return A.apply(this,arguments)})),Object(o.a)(n,"getTransactionReceipt",(E=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,n=t.rootGetters,t.rootState,t.dispatch,t.commit,o=r.txHash,r.customRPC,e.abrupt("return",new Promise((function(e,t){var r=function(){var m=Object(c.a)(regeneratorRuntime.mark((function c(m){var l,d,f,k;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=m.retryAttempt,d=void 0===l?1:l,d++,c.prev=2,c.next=5,n["metamask/aptosClient"]();case 5:return f=c.sent,c.next=8,f.getTransactionByHash(o);case 8:k=c.sent,console.info(k),e(k),c.next=16;break;case 13:c.prev=13,c.t0=c.catch(2),d>=2?t(c.t0):r({retryAttempt:d});case 16:case"end":return c.stop()}}),c,null,[[2,13]])})));return function(e){return m.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return E.apply(this,arguments)})),Object(o.a)(n,"getTransactionInfo",(T=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,n=t.rootGetters,t.rootState,t.dispatch,t.commit,o=r.txHash,r.customRPC,e.abrupt("return",new Promise((function(e,t){var r=function(){var m=Object(c.a)(regeneratorRuntime.mark((function c(m){var l,d,f,k;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=m.retryAttempt,d=void 0===l?1:l,d++,c.prev=2,c.next=5,n["metamask/aptosClient"]();case 5:return f=c.sent,c.next=8,f.getTransactionByHash(o);case 8:k=c.sent,e(k),c.next=15;break;case 12:c.prev=12,c.t0=c.catch(2),d>=2?t(c.t0):r({retryAttempt:d});case 15:case"end":return c.stop()}}),c,null,[[2,12]])})));return function(e){return m.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return T.apply(this,arguments)})),Object(o.a)(n,"getTransactionCount",(v=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,address;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,t.getters,t.rootGetters,t.rootState,o=t.dispatch,t.commit,address=r.address,e.abrupt("return",new Promise((function(e,t){var r=function(){var m=Object(c.a)(regeneratorRuntime.mark((function c(m){var l,d,f,k;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=m.retryAttempt,d=void 0===l?1:l,d++,c.prev=2,f={from:n.ethAccount,method:"eth_getTransactionCount",params:[address,"latest"]},c.next=6,o("metamask/sendAsync",f,{root:!0});case 6:k=c.sent,e(k),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(2),d>=2?t(c.t0):r({retryAttempt:d});case 13:case"end":return c.stop()}}),c,null,[[2,10]])})));return function(e){return m.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)})),Object(o.a)(n,"sendGraphQLRequest",(function(e,t){e.state;var r=e.getters,n=(e.rootState,t.operationsDoc),o=t.customGraphqlURL,m=void 0===o?void 0:o,l=r.networkConfig.graphqlUrls[0];return m&&(l=m),new Promise(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.a)(l,{method:"POST",body:JSON.stringify({query:n,variables:{},operationName:"MyQuery"})});case 3:return o=e.sent,e.next=6,o.json();case 6:c=e.sent,t(c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),r(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r){return e.apply(this,arguments)}}())})),Object(o.a)(n,"sendRrcRequest",(function(e,t){e.state;var r=e.getters,n=(e.rootState,t.params),o=t.customRPC,m=void 0===o?void 0:o,l=r.networkConfig.rpcUrl;return m&&(l=m),new Promise(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var o,c,m,f,data,k,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=parseInt(Date.parse(new Date)),c=!1,Array.isArray(n)?(c=!0,m=[],f=0,n.forEach((function(param,i){param.hasOwnProperty("id")||(param.id=o+f,f+=1),param.jsonrpc="2.0",m.push(param)})),n=m):(n.hasOwnProperty("id")||(n.id=o),n.jsonrpc="2.0"),data=JSON.stringify(n),e.next=7,Object(d.a)(l,{body:data,headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"});case 7:return k=e.sent,e.next=10,k.json();case 10:(h=e.sent).error?r(h.error):c?(v=[],h.forEach((function(e,i){e.error?v.push(e.error):null===e.result.value||null!=e.result.value?v.push(e.result.value):v.push(e.result)})),t(v)):null===h.result.value||null!=h.result.value?t(h.result.value):t(h.result),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),r(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,r){return e.apply(this,arguments)}}())})),n);t.default={namespaced:!0,state:function(){return{ethAccount:null,accountPublicKey:null,netId:1,currency:"APT",domainData:{},balance:"0",initialized:!1,address:{value:null,valid:!1},gasPrice:{fast:1,low:1,standard:1,instant:1},gasPriceOracleLocked:!1,providerName:"",networkName:"",tokens:[],tokensForTestnet:[],tokenAddress:"",isFetching:!0,ethCoinName:" Native Currency",walletState:1,isImToken:!1,isTrustWallet:!1,isMetamask:!0,walletName:"",ethPrice:0,ethPriceLoaded:!1,decimals:8,minTokenAccountInitAmount:2039280,minGasFee:5e3,feeRateGovernor:{burnPercent:50,maxLamportsPerSignature:1e5,minLamportsPerSignature:5e3,targetLamportsPerSignature:1e4,targetSignaturesPerSlot:2e4},tokensList:{},minDeposiBalance:890880,workedRPC:void 0}},getters:K,mutations:B,actions:F}},710:function(e,t,r){"use strict";r.r(t);r(90),r(62),r(79),r(96),r(28),r(45),r(97),r(158),r(30);var n,o,c,m,l,d,f,k,h,v,T,E,A,w,x,_,O,y,S,R,C,P,N,I,j,L,D,G,K,B,F,H,U=r(0),M=(r(74),r(75),r(26),r(6)),V=r(366),Q=r(367),W=r(3),X=(r(41),r(168)),Y={allowanceNumber:function(e){var t=0;try{t=Object(W.a)(e.allowance).gte(Object(W.a)(Math.pow(10,36)))?-1:Object(W.a)(e.allowance).div(Object(W.a)(10).pow(e.tokenSelected.decimals)).toString(10)}catch(e){console.info(e)}return t},balanceNumber:function(e){var t=0;try{t=Object(W.a)(e.balance).div(Object(W.a)(10).pow(e.tokenSelected.decimals)).toString(10)}catch(e){}return t},isNFTToken:function(e,t){return t.isERC721||t.isERC1155},isERC721:function(e){return 1==e.tokenType},isERC1155:function(e){return 2==e.tokenType},tokenInstance:function(e,t,r,n){return Object(U.a)(regeneratorRuntime.mark((function t(){var o,c,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.metamask,c=o.ethAccount,o.netId,t.next=3,n["metamask/web3"]();case 3:return m=t.sent,t.abrupt("return",new m.eth.Contract(V,e.address,{from:c}));case 5:case"end":return t.stop()}}),t)})))},tokenQueryInstance:function(e,t,r,n){return Object(U.a)(regeneratorRuntime.mark((function e(){var t,o,c,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metamask,o=t.ethAccount,t.netId,e.next=3,n["metamask/web3"]();case 3:return c=e.sent,m=n["metamask/networkConfig"].tokenQueryContract,e.abrupt("return",new c.eth.Contract(Q,m,{from:o}));case 6:case"end":return e.stop()}}),e)})))}},$={setTokenAddress:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_ADDRESS",t.address)},setAproveTx:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_APPROVE_TX",t.txHash)},setAproveAmount:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_APPROVE_AMOUNT",t.amount)},setAproveTxStatus:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_APPROVE_TX_STATUS",t.status)},setTokenSelectedDisplayInfo:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_SELECTED_DISPLAY_INFO",t.tokenSelectedDisplayInfo)},setTokenSelected:(H=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.dispatch,o=t.commit,c=t.state,m=r.selected,o("SET_TOKEN_SELECTED",m),o("SET_TOKEN_INFO_LOADED",!0),c.tokenSelected.isETH){e.next=13;break}return e.next=7,n("getTokenDecimals");case 7:l=e.sent,o("SET_TOKEN_DECIMALS",l),n("getTokenAllowce",{}),n("getTokenBalance",{}),e.next=14;break;case 13:o("SET_TOKEN_TYPE",0);case 14:return e.prev=14,e.next=17,n("common/getNetIdStorage",{},{root:!0});case 17:(d=e.sent).lastTokenUsed=m,n("common/updateNetIdStorage",{netStorage:d},{root:!0}),e.next=24;break;case 22:e.prev=22,e.t0=e.catch(14);case 24:case"end":return e.stop()}}),e,null,[[14,22]])}))),function(e,t){return H.apply(this,arguments)}),checkLastTokenSelected:(F=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.commit,t.state,o=null,e.prev=2,e.next=5,r("common/getNetIdStorage",{},{root:!0});case 5:c=e.sent,o=c.lastTokenUsed,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:return n("SET_TOKEN_SELECTED",o),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e,null,[[2,9]])}))),function(e){return F.apply(this,arguments)}),setTokenBalance:function(e,t){e.dispatch;var r=e.commit,n=(e.state,t.balance);r("SET_TOKEN_BALANCE",n),r("SET_TOKEN_BALANCE_LOADED",!0),console.info("Token Balance",n)},setTokenAllowance:function(e,t){e.dispatch;var r=e.commit,n=(e.state,t.allowance);-1!=n&&(r("SET_TOKEN_ALLOWANCE",n),r("SET_TOKEN_ALLOWANCE_LOADED",!0),console.info("Token Allowance",n))},clearUsedParams:(B=Object(U.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state,t.getters,t.dispatch,r=t.commit,t.rootState,r("CLEAR");case 2:case"end":return e.stop()}}),e)}))),function(e){return B.apply(this,arguments)}),initBaseParams:(K=Object(U.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.rootState,t.rootGetters,r=t.dispatch,t.commit,t.state,r("checkLastTokenSelected");case 2:case"end":return e.stop()}}),e)}))),function(e){return K.apply(this,arguments)}),checkAllowceEnough:(G=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,o=t.getters,c=t.commit,m=t.rootState,l=r.finalAmount,d=null!=n.tokenSelected&&n.tokenSelected.isETH||null!=n.tokenSelected&&null!=n.tokenSelected.decimals&&n.allowance>0&&Object(W.a)(n.allowance).div(Object(W.a)(10).pow(n.tokenSelected.decimals)).gte(Object(W.a)(l)),o.isERC721&&(f=m.common.addressInfo,null!=n.tokenSelected.decimals&&(d=n.allowance>0&&Object(W.a)(n.allowance).div(Object(W.a)(10).pow(n.tokenSelected.decimals)).gte(Object(W.a)(f.finalData.length)))),c("SET_TOKEN_ALLOWANCE_ENOUGH",d),e.abrupt("return",d);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return G.apply(this,arguments)}),checkBalanceEnough:(D=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,o=t.getters,c=t.commit,m=t.rootState,l=r.finalAmount,d=m.metamask.balance,f=n.tokenSelected,k=!1,null!=f&&(f.isETH?k=Object(W.a)(d).gte(Object(W.a)(l)):(o.isERC721&&(h=m.common.addressInfo,k=Object(W.a)(n.balance).div(Object(W.a)(10).pow(n.tokenSelected.decimals)).gte(Object(W.a)(h.finalData.length))),o.isERC1155?k=!0:null!=f.decimals&&(k=Object(W.a)(n.balance).div(Object(W.a)(10).pow(n.tokenSelected.decimals)).gte(Object(W.a)(l))))),c("SET_TOKEN_BALANCE_ENOUGH",k),e.abrupt("return",k);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return D.apply(this,arguments)}),getTokenAddress:(L=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,r=t.getters,n=t.commit,e.next=3,r.tokenInstance();case 3:o=e.sent,n("SET_TOKEN_ADDRESS",o._address);case 5:case"end":return e.stop()}}),e)}))),function(e){return L.apply(this,arguments)}),getTokenBalance:(j=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,t.state,t.getters,n=t.rootGetters,t.rootState,(0,t.commit)("SET_TOKEN_BALANCE_LOADED",!1),o=n["metamask/networkConfig"].rpcCallRetryAttempt,e.abrupt("return",new Promise((function(e,t){var n=function(){var c=Object(U.a)(regeneratorRuntime.mark((function c(m){var l,d,f,k;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=m.retryAttempt,d=void 0===l?1:l,d++,c.prev=2,c.next=5,r("getTokenResource",{});case 5:f=c.sent,k=0,f.data&&(k=f.data.coin.value),r("setTokenBalance",{balance:k}),e(k),c.next=15;break;case 12:c.prev=12,c.t0=c.catch(2),d>=o?t(c.t0):n({retryAttempt:d});case 15:case"end":return c.stop()}}),c,null,[[2,12]])})));return function(e){return c.apply(this,arguments)}}();n({})})));case 4:case"end":return e.stop()}}),e)}))),function(e){return j.apply(this,arguments)}),parseInsertTokenAddress:(I=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.dispatch,t.state,t.getters,t.rootGetters,t.rootState,o=t.commit,!((c=r.tokenAddress).startsWith("0x")&&c.split("::").length>2)){e.next=24;break}return o("SET_TOKEN_ADDRESS",c),e.next=6,n("getTokenInfo");case 6:if(m=e.sent,0!=Object.keys(m).length){e.next=23;break}return e.next=10,n("checkTokenType");case 10:l=e.sent,console.info("TokenType2",l),e.t0=l,e.next=1===e.t0?15:2===e.t0?19:23;break;case 15:return e.next=17,n("getERC721TokenInfo");case 17:return m=e.sent,e.abrupt("break",23);case 19:return e.next=21,n("getERC1155TokenInfo");case 21:return m=e.sent,e.abrupt("break",23);case 23:return e.abrupt("return",m);case 24:case"end":return e.stop()}}),e)}))),function(e,t){return I.apply(this,arguments)}),fetchTokenPrice:(N=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,l,d,f,k,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rootState,n=t.commit,o=t.dispatch,c=t.rootGetters,m=t.state,n("SET_PRICE_LOADED",!1),(l=c["metamask/networkConfig"]).smartContractPollTime,l.extraFeeOracle,d=l.supportExtraFee,r.metamask.netId,d){e.next=7;break}return n("SET_PRICE_LOADED",!0),e.abrupt("return");case 7:return e.next=9,o("bulksender/setExtraFee",{extraFee:0},{root:!0});case 9:if(n("SET_TOKEN_PRICE",0),"0x0000000000000000000000000000000000000000"!=(f=m.address)){e.next=14;break}return n("SET_PRICE_LOADED",!0),e.abrupt("return");case 14:if(k=f,!(h=c["metamask/networkConfig"].specialTokenList).includes(f)&&!h.includes(k)){e.next=21;break}return n("SET_TOKEN_PRICE",1),n("SET_PRICE_LOADED",!0),e.abrupt("return");case 21:return e.abrupt("return");case 24:case"end":return e.stop()}}),e)}))),function(e){return N.apply(this,arguments)}),getTokenResource:(P=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,n=t.state,t.getters,o=t.rootGetters,c=t.rootState,m=t.commit,l=r.fetchMeta,d=void 0!==l&&l,f=r.queryAccount,k=void 0===f?void 0:f,e.abrupt("return",new Promise((function(e,t){var r=function(){var l=Object(U.a)(regeneratorRuntime.mark((function l(f){var h,v,T,E,A,w,x,_,O;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return h=f.retryAttempt,v=void 0===h?1:h,v++,l.prev=2,T=c.metamask,E=T.ethAccount,T.tokensList,l.next=6,o["metamask/aptosClient"]();case 6:return A=l.sent,w=n.address,x=w.split("::")[0],_="0x1::coin::CoinStore<"+w+">",d?_="0x1::coin::CoinInfo<"+w+">":x=k||E,l.next=14,A.getAccountResource(x,_);case 14:O=l.sent,m("SET_TOKEN_TYPE",3),e(O),l.next=22;break;case 19:l.prev=19,l.t0=l.catch(2),l.t0.message.includes("Resource not found by")?e({}):v>=1?t(l.t0):r({retryAttempt:v});case 22:case"end":return l.stop()}}),l,null,[[2,19]])})));return function(e){return l.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return P.apply(this,arguments)}),getTokenDecimals:(C=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,t.state,t.getters,n=t.rootGetters,t.rootState,t.commit,o=n["metamask/networkConfig"],c=o.rpcCallRetryAttempt,o.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var n=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(o){var m,l,d,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m=o.retryAttempt,l=void 0===m?1:m,l++,t.prev=2,t.next=5,r("getTokenResource",{fetchMeta:!0});case 5:(d=t.sent).data?(f=d.data.decimals,e(f)):e(8),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),console.info("get Token Info exception",t.t0),l>=c||"execution reverted"==t.t0.message?e({}):n({retryAttempt:l});case 13:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}();n({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return C.apply(this,arguments)}),getTokenInfo:(R=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.state,t.getters,o=t.rootGetters,t.rootState,c=t.commit,m=o["metamask/networkConfig"],l=m.rpcCallRetryAttempt,m.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var o=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(m){var d,f,k,h,v,T,E;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=m.retryAttempt,f=void 0===d?1:d,f++,t.prev=2,t.next=5,r("getTokenResource",{fetchMeta:!0});case 5:if(!(k=t.sent).data){t.next=20;break}return h=k.data,v=0,T={contractAddress:n.address,balance:v,displayBalance:0,name:h.name,symbol:h.symbol,decimals:k.decimals},E=n.unlimitedApproveAmount,t.next=13,r("setTokenSelected",{selected:T});case 13:r("setTokenBalance",{balance:v}),r("setTokenAllowance",{allowance:E}),console.info(T),c("SET_TOKEN_TYPE",3),e(T),t.next=21;break;case 20:e({});case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(2),console.info("get Token Info exception",t.t0),f>=l||"execution reverted"==t.t0.message?e({}):o({retryAttempt:f});case 27:case"end":return t.stop()}}),t,null,[[2,23]])})));return function(e){return t.apply(this,arguments)}}();o({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return R.apply(this,arguments)}),getERC721TokenInfo:(S=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.state,o=t.getters,c=t.rootGetters,m=t.rootState,t.commit,l=c["metamask/networkConfig"],d=l.rpcCallRetryAttempt,l.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var c=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(l){var f,k,h,v,data,T,E,A,w,symbol,x,_,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=l.retryAttempt,k=void 0===f?1:f,k++,t.prev=2,h=m.metamask.ethAccount,m.bulksender.bulksenderAddress,t.next=7,o.tokenQueryInstance();case 7:return v=t.sent,data=v.methods.queryERC721TokenInfo(n.address,h).encodeABI(),T={method:"eth_call",params:[{from:h,to:v._address,data:data},"latest"],from:h},t.next=12,r("metamask/sendAsync",T,{root:!0});case 12:if(null==(E=t.sent)){t.next=21;break}A=X.decodeParameters([{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint256"},{name:"totalSupply",type:"uint256"},{name:"balance",type:"uint256"},{name:"allowance",type:"uint256"}],E),w=A.name,symbol=A.symbol,x=A.decimals,A.totalSupply,_=A.balance,A.allowance,O={contractAddress:n.address,balance:_,name:w,symbol:symbol,decimals:x},r("setTokenSelected",{selected:O}),r("setTokenBalance",{balance:_}),e(O),t.next=22;break;case 21:throw Error("Fetch token info failed");case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(2),k>=d?e({}):c({retryAttempt:k});case 27:case"end":return t.stop()}}),t,null,[[2,24]])})));return function(e){return t.apply(this,arguments)}}();c({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)}),getERC1155TokenInfo:(y=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.state,o=t.getters,c=t.rootGetters,m=t.rootState,t.commit,l=c["metamask/networkConfig"],d=l.rpcCallRetryAttempt,l.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var c=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(l){var f,k,h,v,symbol,T;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=l.retryAttempt,k=void 0===f?1:f,k++,t.prev=2,m.metamask.ethAccount,m.bulksender.bulksenderAddress,t.next=7,o.tokenQueryInstance();case 7:return t.sent,t.next=10,r("getBaseNFTTokenInfo");case 10:h=t.sent,v=h.name,symbol=h.symbol,console.info(v),T={contractAddress:n.address,balance:0,name:v,symbol:symbol,decimals:0},r("setTokenSelected",{selected:T}),r("setTokenBalance",{balance:0}),e(T),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(2),k>=d?e({}):c({retryAttempt:k});case 24:case"end":return t.stop()}}),t,null,[[2,21]])})));return function(e){return t.apply(this,arguments)}}();c({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)}),getBaseNFTTokenInfo:(O=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.state,o=t.getters,c=t.rootGetters,m=t.rootState,t.commit,l=c["metamask/networkConfig"],d=l.rpcCallRetryAttempt,l.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var c=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(l){var f,k,h,v,data,T,E,A,w,symbol;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=l.retryAttempt,k=void 0===f?1:f,k++,t.prev=2,h=m.metamask.ethAccount,m.bulksender.bulksenderAddress,t.next=7,o.tokenQueryInstance();case 7:return v=t.sent,data=v.methods.queryERC721TokenBaseInfo(n.address).encodeABI(),T={method:"eth_call",params:[{from:h,to:v._address,data:data},"latest"],from:h},t.next=12,r("metamask/sendAsync",T,{root:!0});case 12:if(null==(E=t.sent)){t.next=18;break}A=X.decodeParameters([{name:"name",type:"string"},{name:"symbol",type:"string"}],E),w=A.name,symbol=A.symbol,e({name:w,symbol:symbol}),t.next=19;break;case 18:throw Error("Fetch token info failed");case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(2),k>=d||"execution reverted"==t.t0.message?e({name:"NFT-ERC1155",symbol:"ERC1155"}):c({retryAttempt:k});case 24:case"end":return t.stop()}}),t,null,[[2,21]])})));return function(e){return t.apply(this,arguments)}}();c({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)}),checkTokenType:(_=Object(U.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,t.getters,t.rootGetters,t.rootState,(0,t.commit)("SET_TOKEN_TYPE",3),e.abrupt("return",3);case 3:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)}),checkNFTType:(x=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,t.state,o=t.getters,c=t.rootGetters,m=t.rootState,t.commit,l=r.isERC721,d=c["metamask/networkConfig"],f=d.rpcCallRetryAttempt,d.tokenQueryContract,d.supportsNFT,e.abrupt("return",new Promise((function(e,t){var r=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(c){var d,k,h,v,T,E,data,A;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=c.retryAttempt,k=void 0===d?1:d,k++,t.prev=2,h=!1,v=m.metamask.ethAccount,t.next=7,o.tokenInstance();case 7:return T=t.sent,E="0xd9b67a26",l&&(E="0x80ac58cd"),data=T.methods.supportsInterface(E).encodeABI(),A={method:"eth_call",params:[{from:v,to:T._address,data:data},"latest"],from:v},t.next=14,n("metamask/sendAsync",A,{root:!0});case 14:h=t.sent,h=Object(M.hexToNumberString)(h),e(h="1"==h||1==h),t.next=24;break;case 20:t.prev=20,t.t0=t.catch(2),console.info("Check token type again:",t.t0),k>=f||"execution reverted"==t.t0.message?e(!1):r({retryAttempt:k});case 24:case"end":return t.stop()}}),t,null,[[2,20]])})));return function(e){return t.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return x.apply(this,arguments)}),bulkQueryTokenAccounts:(w=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,o=t.state,t.getters,c=t.rootGetters,m=t.rootState,t.commit,r.tokenAddress,l=r.addresses,r.tokenIds,d=c["metamask/networkConfig"],f=d.rpcCallRetryAttempt,d.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var d=Object(U.a)(regeneratorRuntime.mark((function d(k){var h,v,T,E,A,w,x,address,_,O,y,S,R,C,P,N,I,j,L;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return h=k.retryAttempt,v=void 0===h?1:h,v++,d.prev=2,T=m.metamask.accountPublicKey,T=new PublicKey(T),d.next=7,c["metamask/connection"]();case 7:if(E=d.sent,A=[],w=[],!o.tokenSelected.isETH){d.next=14;break}for(x=0;x<l.length;x++)address=l[x],_=new PublicKey(address),O=_,w.push(O),A.push({method:"getAccountInfo",params:[O.toString(),{encoding:"jsonParsed"}]});d.next=29;break;case 14:y=o.address,S=new PublicKey(y),R=new Token(E,S,TOKEN_PROGRAM_ID,T),x=0;case 18:if(!(x<l.length)){d.next=29;break}return C=l[x],P=new PublicKey(C),d.next=23,Token.getAssociatedTokenAddress(R.associatedProgramId,R.programId,R.publicKey,P);case 23:N=d.sent,w.push(N),A.push({method:"getAccountInfo",params:[N.toString(),{encoding:"jsonParsed"}]});case 26:x++,d.next=18;break;case 29:return I={params:A},d.next=32,n("metamask/sendRrcRequest",I,{root:!0});case 32:j=d.sent,L=[],j.forEach((function(e,i){if(null==e)L.push({isNew:!0,tokenAccount:w[i]});else{if(!e.hasOwnProperty("owner"))throw Error("Query accounts failed");L.push({isNew:!1,tokenAccount:w[i]})}})),e(L),d.next=42;break;case 38:d.prev=38,d.t0=d.catch(2),console.info(d.t0),v>=f?t(d.t0):r({retryAttempt:v});case 42:case"end":return d.stop()}}),d,null,[[2,38]])})));return function(e){return d.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return w.apply(this,arguments)}),bulkFindBadTokenAccounts:(A=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,o=t.state,t.getters,t.rootGetters,t.rootState,t.commit,c=r.tokenAddress,m=r.addresses,e.abrupt("return",new Promise((function(e,t){var r=function(){var l=Object(U.a)(regeneratorRuntime.mark((function l(d){var f,k,h,v,address;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return f=d.retryAttempt,k=void 0===f?1:f,k++,l.prev=2,h=[],l.prev=4,l.next=7,n("bulkFindBadTokenAccountsFromGraphQL",{tokenAddress:c,addresses:m});case 7:h=l.sent,l.next=23;break;case 10:if(l.prev=10,l.t0=l.catch(4),o.tokenSelected.isETH){l.next=23;break}v=0;case 14:if(!(v<m.length)){l.next=23;break}return address=m[v],l.next=18,n("getTokenResource",{fetchMeta:!1,queryAccount:address});case 18:l.sent.data?h.push("0x0000000000000000000000000000000000000000"):h.push(address);case 20:v++,l.next=14;break;case 23:e(h),l.next=29;break;case 26:l.prev=26,l.t1=l.catch(2),k>=2?t(l.t1):r({retryAttempt:k});case 29:case"end":return l.stop()}}),l,null,[[2,26],[4,10]])})));return function(e){return l.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return A.apply(this,arguments)}),bulkFindBadTokenAccountsFromGraphQL:(E=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,o=t.state,t.getters,t.rootGetters,t.rootState,t.commit,c=r.tokenAddress,m=r.addresses,e.abrupt("return",new Promise((function(e,t){var r=function(){var l=Object(U.a)(regeneratorRuntime.mark((function l(d){var f,k,h,v,T,address,E,A,w;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(f=d.retryAttempt,k=void 0===f?1:f,k++,l.prev=2,h=[],o.tokenSelected.isETH){l.next=14;break}for(v=[],T=0;T<m.length;T++)address=m[T],v.push('"'+address+'"');return E=(E='\n            query MyQuery {\n              current_coin_balances(\n                where: {coin_type: {_eq: "$tokenAddress"}, owner_address: {_in: [$accounts]}}\n                offset: 0\n                limit: 10\n              ) {\n                amount\n                owner_address\n                coin_type\n              }\n            }\n          ').replace("$accounts",v.join(",")).replace("$tokenAddress",c),l.next=11,n("metamask/sendGraphQLRequest",{operationsDoc:E},{root:!0});case 11:A=l.sent,w={},A&&A.data&&A.data.current_coin_balances&&A.data.current_coin_balances.forEach((function(e,i){w[e.owner_address.toLowerCase()]=!0}));case 14:m.forEach((function(e,i){w[e.toLowerCase()]?h.push("0x0000000000000000000000000000000000000000"):h.push(e)})),e(h),l.next=21;break;case 18:l.prev=18,l.t0=l.catch(2),k>=2?t(l.t0):r({retryAttempt:k});case 21:case"end":return l.stop()}}),l,null,[[2,18]])})));return function(e){return l.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return E.apply(this,arguments)}),bulkQueryBalances:(T=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,t.state,o=t.getters,c=t.rootGetters,m=t.rootState,t.commit,l=r.tokenAddress,d=r.addresses,f=r.tokenIds,k=c["metamask/networkConfig"],h=k.rpcCallRetryAttempt,k.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var c=Object(U.a)(regeneratorRuntime.mark((function c(k){var v,T,E,A,data,w,x,_,O;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return v=k.retryAttempt,T=void 0===v?1:v,T++,c.prev=2,E=m.metamask.ethAccount,c.next=6,o.tokenQueryInstance();case 6:return A=c.sent,data=o.isERC1155?A.methods.bulkQueryERC1155Balances(l,d,f).encodeABI():A.methods.bulkQueryBalances(l,d).encodeABI(),w={method:"eth_call",params:[{from:E,to:A._address,data:data},"latest"],from:E},c.next=11,n("metamask/sendAsync",w,{root:!0});case 11:if(null==(x=c.sent)){c.next=17;break}_=X.decodeParameters([{name:"balances",type:"uint256[]"}],x),O=_.balances,e(O),c.next=18;break;case 17:throw Error("BulkQueryBalances failed");case 18:c.next=23;break;case 20:c.prev=20,c.t0=c.catch(2),T>=h?t(c.t0):r({retryAttempt:T});case 23:case"end":return c.stop()}}),c,null,[[2,20]])})));return function(e){return c.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return T.apply(this,arguments)}),checkApproveTransactionStatus:(v=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,l,d,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,t.getters,n=t.rootGetters,t.rootState,o=t.dispatch,c=t.commit,m=r.approveTx,l=r.approveAmount,d=n["metamask/networkConfig"].smartContractShortPollTime,e.prev=4,e.next=7,o("metamask/getTransactionReceipt",{txHash:m},{root:!0});case 7:null!=(f=e.sent)?(k=f.status,c("SET_TOKEN_APPROVE_TX_STATUS",k="0x1"==k||1==k?1:-2),c("SET_TOKEN_ALLOWANCE",l)):setTimeout((function(){o("checkApproveTransactionStatus")}),1e3*d),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),setTimeout((function(){o("checkApproveTransactionStatus")}),1e3*d);case 14:case"end":return e.stop()}}),e,null,[[4,11]])}))),function(e){return v.apply(this,arguments)}),getTokenAllowce:(h=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.rootState,t.getters,r=t.commit,n=t.dispatch,o=t.rootGetters,c=t.state,r("SET_TOKEN_ALLOWANCE_LOADED",!1),m=o["metamask/networkConfig"],l=m.rpcCallRetryAttempt,m.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(o){var m,d,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:m=o.retryAttempt,d=void 0===m?1:m,d++;try{f=c.unlimitedApproveAmount,n("setTokenAllowance",{allowance:f}),e(f)}catch(t){d>=l||"execution reverted"==t.message?e(0):r({retryAttempt:d})}case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)}),approveForBulksender:(k=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,t.getters,o=t.rootState,t.rootGetters,c=t.dispatch,t.commit,(m=r.amount)!=n.unlimitedApproveAmount&&(m=Object(W.a)(m).times(Object(W.a)(10).pow(parseInt(n.tokenSelected.decimals))).toString(10)),l=o.bulksender.bulksenderAddress,e.next=6,c("approve",{bulksenderAddress:l,amount:m});case 6:return d=e.sent,e.abrupt("return",d);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return k.apply(this,arguments)}),approveForBulksenderForNFTToken:(f=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,t.getters,o=t.rootState,t.rootGetters,c=t.dispatch,t.commit,r.amount,l=o.bulksender.bulksenderAddress,m=n.unlimitedApproveAmount,e.next=7,c("_approveForNFTToken",{bulksenderAddress:l,setApproveAll:!0,amount:m});case 7:return d=e.sent,e.abrupt("return",d);case 9:case"end":return e.stop()}}),e)}))),function(e,t){return f.apply(this,arguments)}),revokeApproveOfBulksenderForNFTToken:(d=Object(U.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,r=t.rootState,t.rootGetters,n=t.dispatch,t.commit,o=r.bulksender.bulksenderAddress,e.next=6,n("_approveForNFTToken",{bulksenderAddress:o,setApproveAll:!1,amount:0});case 6:return c=e.sent,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)}),checkAddressIsContract:(l=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,t.state,o=t.getters,c=t.rootGetters,m=t.rootState,t.commit,l=r.addresses,d=c["metamask/networkConfig"],f=d.rpcCallRetryAttempt,d.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var c=Object(U.a)(regeneratorRuntime.mark((function c(d){var k,h,v,T,data,E,A,w,x;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return k=d.retryAttempt,h=void 0===k?1:k,h++,c.prev=2,v=m.metamask.ethAccount,c.next=6,o.tokenQueryInstance();case 6:return T=c.sent,data=T.methods.bulkCheckIfContracts(l).encodeABI(),E={method:"eth_call",params:[{from:v,to:T._address,data:data},"latest"],from:v},c.next=11,n("metamask/sendAsync",E,{root:!0});case 11:if(null==(A=c.sent)){c.next=17;break}w=X.decodeParameters([{name:"contracts",type:"address[]"}],A),x=w.contracts,e(x),c.next=18;break;case 17:throw Error("bulkCheckIfContracts failed");case 18:c.next=23;break;case 20:c.prev=20,c.t0=c.catch(2),h>=f?t(c.t0):r({retryAttempt:h});case 23:case"end":return c.stop()}}),c,null,[[2,20]])})));return function(e){return c.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)}),checkTokenOwners:(m=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,o=t.state,c=t.getters,m=t.rootGetters,l=t.rootState,t.commit,d=r.tokenIds,f=m["metamask/networkConfig"],k=f.rpcCallRetryAttempt,f.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var m=Object(U.a)(regeneratorRuntime.mark((function m(f){var h,v,T,E,data,A,w,x,_;return regeneratorRuntime.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return h=f.retryAttempt,v=void 0===h?1:h,v++,m.prev=2,T=l.metamask.ethAccount,m.next=6,c.tokenQueryInstance();case 6:return E=m.sent,data=E.methods.bulkQueryERC721Owers(o.address,d).encodeABI(),A={method:"eth_call",params:[{from:T,to:E._address,data:data},"latest"],from:T},m.next=11,n("metamask/sendAsync",A,{root:!0});case 11:if(null==(w=m.sent)){m.next=17;break}x=X.decodeParameters([{name:"addrOwners",type:"address[]"}],w),_=x.addrOwners,e(_),m.next=18;break;case 17:throw Error("bulkCheckIfContracts failed");case 18:m.next=23;break;case 20:m.prev=20,m.t0=m.catch(2),v>=k?t(m.t0):r({retryAttempt:v});case 23:case"end":return m.stop()}}),m,null,[[2,20]])})));return function(e){return m.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)}),checkApproval:(c=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k,h,v,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,o=t.getters,c=t.rootState,t.rootGetters,m=t.dispatch,l=t.commit,d=r.amount,f=n.checkZeroTimes,d=Object(W.a)(d).times(Object(W.a)(10).pow(parseInt(n.tokenSelected.decimals))).toString(10),k=c.bulksender.bulksenderAddress,e.next=7,o.tokenInstance();case 7:return h=e.sent,v=c.metamask.ethAccount,T=0,e.abrupt("return",new Promise((function(e,t){var r=function(){var t=Object(U.a)(regeneratorRuntime.mark((function t(n){var o,c,E,data,A,w;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.retryAttempt,c=void 0===o?0:o,c++,t.prev=2,(E=c>=Math.ceil(f/2)+1)&&(d="0"),data=h.methods.approve(k,d).encodeABI(),A={method:"eth_estimateGas",params:[{from:v,to:h._address,data:data,value:Object(M.numberToHex)(0)}],from:v},t.next=9,m("metamask/sendAsync",A,{root:!0});case 9:w=t.sent,w=Object(M.hexToNumber)(w),l("SET_NEED_TO_RESET_APPROVAL",E),E&&(T=-1),e({usedApproveZero:E,errorType:T}),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(2),c>=f?e({usedApproveZero:!0,errorType:T=-2}):r({retryAttempt:c});case 19:case"end":return t.stop()}}),t,null,[[2,16]])})));return function(e){return t.apply(this,arguments)}}();r({})})));case 11:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)}),approve:(o=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k,h,v,T,E,data,A,w,x,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,n=t.getters,o=t.rootState,c=t.rootGetters,m=t.dispatch,l=t.commit,d=r.bulksenderAddress,f=r.amount,k=0,h=null,e.prev=4,v=o.metamask.ethAccount,T=o.metamask.gasPrice.fast,c["metamask/networkConfig"].specialAccountList.includes(v)&&(T=o.metamask.gasPrice.instant),e.next=11,n.tokenInstance();case 11:return E=e.sent,data=E.methods.approve(d,f).encodeABI(),A={method:"eth_estimateGas",params:[{from:v,to:E._address,data:data,value:Object(M.numberToHex)(0)}],from:v},e.next=16,m("metamask/sendAsync",A,{root:!0});case 16:return w=e.sent,w=Object(M.hexToNumber)(w),console.log("approve tx",w),x={method:"eth_sendTransaction",params:[{from:v,to:E._address,gas:Object(M.numberToHex)(w+5e4),gasPrice:Object(M.toHex)(Object(M.toWei)(T.toString(),"gwei")),value:Object(M.numberToHex)(0),data:data}],from:v},e.next=22,m("metamask/sendAsync",x,{root:!0});case 22:return _=e.sent,l("ADD_TX",_),l("SET_TOKEN_APPROVE_TX",_),l("SET_TOKEN_APPROVE_TX_STATUS",0),l("SET_TOKEN_APPROVE_AMOUNT",f),m("checkApproveTransactionStatus"),e.abrupt("return",{txHash:_,errorType:k});case 31:return e.prev=31,e.t0=e.catch(4),console.info(e.t0),e.abrupt("return",{txHash:h,errorType:k});case 35:case"end":return e.stop()}}),e,null,[[4,31]])}))),function(e,t){return o.apply(this,arguments)}),_approveForNFTToken:(n=Object(U.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k,h,v,T,E,A,data,w,x,_,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,n=t.getters,o=t.rootState,c=t.rootGetters,m=t.dispatch,l=t.commit,d=r.bulksenderAddress,f=r.setApproveAll,k=r.amount,h=0,v=null,e.prev=4,T=o.metamask.ethAccount,E=o.metamask.gasPrice.fast,c["metamask/networkConfig"].specialAccountList,e.next=10,n.tokenInstance();case 10:return A=e.sent,data=A.methods.setApprovalForAll(d,f).encodeABI(),w={method:"eth_estimateGas",params:[{from:T,to:A._address,data:data,value:Object(M.numberToHex)(0)}],from:T},e.next=15,m("metamask/sendAsync",w,{root:!0});case 15:return x=e.sent,x=Object(M.hexToNumber)(x),console.log("approve tx",x),_={method:"eth_sendTransaction",params:[{from:T,to:A._address,gas:Object(M.numberToHex)(x+5e4),gasPrice:Object(M.toHex)(Object(M.toWei)(E.toString(),"gwei")),value:Object(M.numberToHex)(0),data:data}],from:T},e.next=21,m("metamask/sendAsync",_,{root:!0});case 21:return O=e.sent,l("ADD_TX",O),l("SET_TOKEN_APPROVE_TX",O),l("SET_TOKEN_APPROVE_TX_STATUS",0),l("SET_TOKEN_APPROVE_AMOUNT",k),m("checkApproveTransactionStatus"),e.abrupt("return",{txHash:O,errorType:h});case 30:return e.prev=30,e.t0=e.catch(4),console.info(e.t0),e.abrupt("return",{txHash:v,errorType:h});case 34:case"end":return e.stop()}}),e,null,[[4,30]])}))),function(e,t){return n.apply(this,arguments)})};t.default={namespaced:!0,state:function(){return{address:null,balance:0,balanceDisplay:"",allowance:0,allowanceNumber:0,balanceNumber:0,allowanceEnough:!1,balanceEnough:!1,approveAmount:0,approveTx:"",approveTxStatus:-1,tokenSelected:null,tokenSelectedDisplayInfo:"",txs:[],tokenBalanceLoaded:!1,tokenAllowanceLoaded:!1,tokenInfoLoaded:!1,checkZeroTimes:4,needToResetApproval:!1,isERC721:!1,isERC1155:!1,tokenType:3,isNFTToken:!1,nftApproveAmount:"100000000000000000000000000000000000000001",unlimitedApproveAmount:"115792089237316195423570985008687907853269984665640564039457584007913129639935",price:0,priceLoaded:!1}},getters:Y,mutations:{SET_TOKEN_ADDRESS:function(e,address){e.address=address},SET_TOKEN_BALANCE:function(e,t){e.balance=t},SET_TOKEN_SELECTED:function(e,t){e.tokenSelected=t},SET_TOKEN_SELECTED_DISPLAY_INFO:function(e,t){e.tokenSelectedDisplayInfo=t},SET_TOKEN_ALLOWANCE:function(e,t){e.allowance=t},SET_TOKEN_ALLOWANCE_ENOUGH:function(e,t){e.allowanceEnough=t},SET_TOKEN_BALANCE_ENOUGH:function(e,t){e.balanceEnough=t},SET_TOKEN_APPROVE_AMOUNT:function(e,t){e.approveAmount=t},SET_TOKEN_APPROVE_TX:function(e,t){e.approveTx=t},SET_TOKEN_APPROVE_TX_STATUS:function(e,t){e.approveTxStatus=t},SET_TOKEN_BALANCE_LOADED:function(e,t){e.tokenBalanceLoaded=t},SET_TOKEN_ALLOWANCE_LOADED:function(e,t){e.tokenAllowanceLoaded=t},SET_TOKEN_INFO_LOADED:function(e,t){e.tokenInfoLoaded=t},SET_NEED_TO_RESET_APPROVAL:function(e,t){e.needToResetApproval=t},SET_IS_ERC_721:function(e,t){e.isERC721=t},SET_TOKEN_TYPE:function(e,t){e.tokenType=t},SET_TOKEN_DECIMALS:function(e,t){e.tokenSelected.decimals=t},SET_TOKEN_PRICE:function(e,t){e.price=t},SET_PRICE_LOADED:function(e,t){e.priceLoaded=t},ADD_TX:function(e,t){e.txs.push(t)},CLEAR:function(e){e.approveTx="",e.approveTxStatus=-1,e.needToResetApproval=!1}},actions:$}},711:function(e,t,r){"use strict";r.r(t);r(97),r(159),r(30);var n,o=r(0),c=r(58),m=(c.b.AccountAddress,c.b.TypeTagStruct,c.b.EntryFunction,c.b.StructTag,c.b.TransactionPayloadEntryFunction,c.b.RawTransaction,c.b.ChainId,{signTransaction:(n=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,l,d,f,k,h,v,data,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,n=t.rootState,t.commit,o=t.rootGetters,t.dispatch,c=r.payload,m=r.options,e.next=4,o["metamask/getEthereumProvider"]();case 4:l=e.sent,d=n.metamask,f=d.providerName,k=d.ethAccount,e.t0=f,e.next="Fewcha"===e.t0?9:"SafePal"===e.t0||"Martian"===e.t0?16:("Pontem"===e.t0||e.t0,23);break;case 9:return e.next=11,l.aptos.generateTransaction(c);case 11:return h=e.sent.data,e.next=14,l.signTransaction(h);case 14:return v=e.sent.data,e.abrupt("return",Uint8Array.from(v));case 16:return e.next=18,l.generateTransaction(k,c,m);case 18:return h=e.sent,e.next=21,l.signTransaction(h);case 21:return v=e.sent,e.abrupt("return",Uint8Array.from(v.split(",")));case 23:return e.next=25,l.signTransaction(c,m);case 25:for(T in v=e.sent,data=[],v)data.push(v[T]);return e.abrupt("return",Uint8Array.from(data));case 29:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})});t.default={namespaced:!0,state:function(){return{}},getters:{},mutations:{},actions:m}}}]);